$('.modal-content').html('<%= j render "form" %>');
$(".modal-state").prop('checked', true);

myDropzoneImage = new Dropzone("#new_jingle", {
 paramName: 'jingle[image_attributes][file]',
 acceptedFiles: 'image/*',
 autoProcessQueue: false,
 init: function() {
   this.on('sending', function(file, xhr, formData) {
     $('input[name^=jingle]').each(function(index, elem) {
       formData.append(elem.name, elem.value);
     });
   });
 },
 success: function(response) {
   $('#new_jingle .upload-progress').hide().find('.bar').css('width', "0%");
   eval(response.xhr.response);
 },
 uploadprogress: function(file, progress) {
   $('#new_jingle .upload-progress').show().find('.bar').css('width', progress + "%");
 },
 drop: function() {
   return $('.dz-complete .dz-error-message').html('');
 }
});

$('#new_jingle').on('submit', function(){
  myDropzoneImage.processQueue();
  return false;
});